<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Your Avatar</title>
</head>
<body>
  <h2>Create Your Avatar</h2>
  
  <!-- Avatar Options -->
  <label>Gender:</label>
  <select id="gender">
    <option value="female">Female</option>
    <option value="male">Male</option>
  </select>

  <label>Hair Color:</label>
  <select id="hair_color">
    <option value="brown">Brown</option>
    <option value="black">Black</option>
    <option value="blonde">Blonde</option>
  </select>

  <label>Skin Tone:</label>
  <select id="skin_tone">
    <option value="light">Light</option>
    <option value="medium">Medium</option>
    <option value="dark">Dark</option>
  </select>

  <button id="generateAvatarBtn">Generate Avatar</button>

  <img id="avatarPreview" src="" alt="Avatar Preview" style="display:none; width:200px; border-radius:50%;">

<script>
const userId = localStorage.getItem("userId");
const generateBtn = document.getElementById("generateAvatarBtn");
const avatarPreview = document.getElementById("avatarPreview");

generateBtn.addEventListener("click", async () => {
  const gender = document.getElementById("gender").value;
  const hair_color = document.getElementById("hair_color").value;
  const skin_tone = document.getElementById("skin_tone").value;

  try {
    const res = await fetch("http://127.0.0.1:5000/generate-avatar", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ user_id: userId, gender, hair_color, skin_tone })
    });

    const data = await res.json();
    if (res.ok) {
      avatarPreview.src = data.avatar_url;
      avatarPreview.style.display = "block";
      alert("Avatar generated & saved!");
    } else {
      alert("Error generating avatar");
    }
  } catch(err) {
    console.error(err);
    alert("Server error");
  }
});
</script>

</body>
</html>
